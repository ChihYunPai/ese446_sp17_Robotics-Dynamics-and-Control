function [qdd]=qdd(tau1,tau2,tau3,theta1,theta2,theta3,theta1dot,theta2dot,theta3dot,L1,L2,L3,m1,m2,m3,I1,I2,I3,g,f1,f2,f3,P0)
% qdd: return numerical state variable tau q double dot given q and qdot
%   inputs: 
%           tau: torques tau=[tau1;tau2;tau3]
%           q: theta1, theta2, theta3
%           qdot: theta1dot, theta2dot, theta3dot
%           L1, L2, L3
%           m1, m2, m3: mass
%           I1, I2, I3: inertia
%           P0: world frame origin
P0 = [0;0;0;1];
I3=.1;
I2=.2;
if nargin<13, I1=.5;end 				%(kg-m2)
if nargin<12, m3=10;end 				%(kg)
if nargin<11, m2=15;end 				%(kg)
if nargin<10, m1=20;end 				%(kg)
if nargin<9, L3=2;end   				%(meters)
if nargin<8, L2=3;end   				%(meters)
if nargin<7, L1=4;end   				%(meters)
if nargin<6, init_theta3=30;end	 %(degrees)
if nargin<5, init_theta2=20;end  %(degrees)
if nargin<4, init_theta1=10;end  %(degrees)
Ic1=diag([I1,I1,I1]);
Ic2=diag([I2,I2,I2]);
Ic3=diag([I3,I3,I3]);

c1=cos(theta1);
c2=cos(theta2);
% c3=cos(theta3);
s1=sin(theta1);
s2=sin(theta2);
% s3=sin(theta3);
c12=cos(theta1+theta2);
s12=sin(theta1+theta2);

M=...
[ I1 + I2 + I3 + m3*(L1*s1 + L2*(s12))^2 + L1^2*m2*s1^2 - L2*m3*(s12)*(L1*c1 + L2*(c12)), I2 + I3 - m3*(L1*c1 + L2*(c12))*(L1*s1 + L2*(s12)) - L1^2*c1*m2*s1 + L2*m3*(c12)*(L1*c1 + L2*(c12)), I3;...
  I2 + I3 - L2^2*m3*(s12)*(c12) + L2*m3*(s12)*(L1*s1 + L2*(s12)),                                                    I2 + I3 + L2^2*m3*(c12)^2 - L2*m3*(s12)*(L1*c1 + L2*(c12)), I3;...
I3,I3,I3];

C =...
[ m3*(L2*(c12) + L1*c1)*(L2*(s12) + L1*s1) + L1^2*m2*c1*s1 - (L2*m3*(L2*(c12) + L1*c1)*(c12))/2 + (L2*m3*(L2*(s12) + L1*s1)*(s12))/2, (L2*m3*(L2*(s12) + L1*s1)*(s12))/2 - (L2*m3*(L2*(c12) + L1*c1)*(c12))/2 - L2*m3*(L2*(c12) + L1*c1)*(s12), 0;...
(L2^2*m3*(s12)^2)/2 - L2^2*m3*(c12)^2 + L2*m3*(L2*(c12) + L1*c1)*(s12) + (L2*m3*(L2*(c12) + L1*c1)*(c12))/2, (L2^2*m3*(s12)^2)/2 - L2^2*m3*(s12)*(c12) - (L2*m3*(L2*(c12) + L1*c1)*(c12))/2, 0;...
0, 0, 0];

B =...
[L2^2*m3*(s12)^2 - L2*m3*(L2*(c12) + L1*c1)*(c12) + 2*L2*m3*(L2*(s12) + L1*s1)*(c12), 0, 0;...
 L2^2*m3*(s12)^2 - L2^2*m3*(c12)^2 + L2*m3*(L2*(c12) + L1*c1)*(s12) + L2*m3*(L2*(s12) + L1*s1)*(c12), 0, 0;...
 0, 0, 0];

F=[f1;f2;f3];

G=-(Jv1'*[0;0;m1*g]+Jv2'*[0;0;m2*g]+Jv3'*[0;0;m3*g]); 
% still not sure this equation
qdd=
 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ((((L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - L1^2*m2*cos(theta1)*sin(theta1) - m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1)) - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta1dot^2 + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - 2*L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta2dot^2 - f1 + tau1 + g*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1)) + L1*g*m2*cos(theta1))*(I2 + L2^2*m3*sin(theta1)^2*sin(theta2)^2 + L2^2*m3*cos(theta1)^2*cos(theta2)^2 - L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) + L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - L1*L2*m3*cos(theta1)^2*sin(theta2) - 2*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) - ((((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta1dot^2 + (L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + ((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta2dot^2 + f2 - tau2 - L2*g*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*(L1^2*m2*cos(theta1)*sin(theta1) - L2^2*m3*sin(theta1)^2*sin(theta2)^2 - I2 + L1^2*m3*cos(theta1)*sin(theta1) - L2^2*m3*cos(theta1)^2*cos(theta2)^2 + L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) + L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - L1*L2*m3*cos(theta1)^2*cos(theta2) - L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 - L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta1)^2*sin(theta2) - L1*L2*m3*sin(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 2*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) + 2*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) + ((f3 - tau3)*(L1^2*m2*cos(theta1)*sin(theta1) + L1^2*m3*cos(theta1)*sin(theta1) - L1*L2*m3*cos(theta1)^2*cos(theta2) - L1*L2*m3*sin(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ((f3 - tau3)*(I1 + L1^2*m2*sin(theta1)^2 + L1^2*m3*sin(theta1)^2 + L1*L2*m3*cos(theta2)*sin(theta1)^2 - L1*L2*m3*cos(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) - L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) - ((((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta1dot^2 + (L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + ((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta2dot^2 + f2 - tau2 - L2*g*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*(I1 + I2 + L1^2*m2*sin(theta1)^2 + L1^2*m3*sin(theta1)^2 + L2^2*m3*cos(theta1)^2*sin(theta2)^2 + L2^2*m3*cos(theta2)^2*sin(theta1)^2 - L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) + L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) + 2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - L1*L2*m3*cos(theta1)^2*sin(theta2) + 2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 2*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) - ((((L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - L1^2*m2*cos(theta1)*sin(theta1) - m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1)) - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta1dot^2 + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - 2*L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta2dot^2 - f1 + tau1 + g*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1)) + L1*g*m2*cos(theta1))*(I2 + L2^2*m3*cos(theta1)^2*sin(theta2)^2 + L2^2*m3*cos(theta2)^2*sin(theta1)^2 - L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) + L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta2)*sin(theta1)^2 + L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 2*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2))
 ((((L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - L1^2*m2*cos(theta1)*sin(theta1) - m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1)) - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta1dot^2 + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - 2*L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)*theta2dot^2 - f1 + tau1 + g*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1)) + L1*g*m2*cos(theta1))*(L2^2*m3*cos(theta1)^2*sin(theta2)^2 - L2^2*m3*cos(theta1)^2*cos(theta2)^2 - L2^2*m3*sin(theta1)^2*sin(theta2)^2 + L2^2*m3*cos(theta2)^2*sin(theta1)^2 + L1*L2*m3*cos(theta2)*sin(theta1)^2 + L1*L2*m3*cos(theta1)^2*sin(theta2) + L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 4*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) + L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) + ((((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta1dot^2 + (L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 - L2^2*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2 + L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L2*m3*(L2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + L1*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*theta1dot*theta2dot + ((L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 - L2^2*m3*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) - (L2*m3*(L2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + L1*cos(theta1))*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)*theta2dot^2 + f2 - tau2 - L2*g*m3*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))*(I1 + L1^2*m2*sin(theta1)^2 + L1^2*m3*sin(theta1)^2 - L2^2*m3*sin(theta1)^2*sin(theta2)^2 + L1^2*m2*cos(theta1)*sin(theta1) + L1^2*m3*cos(theta1)*sin(theta1) - L2^2*m3*cos(theta1)^2*cos(theta2)^2 + L2^2*m3*cos(theta1)^2*sin(theta2)^2 + L2^2*m3*cos(theta2)^2*sin(theta1)^2 - L1*L2*m3*cos(theta1)^2*cos(theta2) + 2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - L1*L2*m3*sin(theta1)^2*sin(theta2) + 3*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 4*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) + L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1)))/(I1*I2 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)) - ((f3 - tau3)*(I1*I2 + I1*I3 + I2*L1^2*m2*sin(theta1)^2 + I2*L1^2*m3*sin(theta1)^2 + I3*L1^2*m2*sin(theta1)^2 + I3*L1^2*m3*sin(theta1)^2 + L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*L1^2*m2*cos(theta1)*sin(theta1) + I2*L1^2*m3*cos(theta1)*sin(theta1) + I3*L1^2*m2*cos(theta1)*sin(theta1) + I3*L1^2*m3*cos(theta1)*sin(theta1) + L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 - I1*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*L1*L2*m3*cos(theta1)^2*cos(theta2) - I3*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*L1*L2*m3*cos(theta1)^2*sin(theta2) + I3*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I3*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*L1*L2*m3*sin(theta1)^2*sin(theta2) - I3*L1*L2*m3*sin(theta1)^2*sin(theta2) - 2*I1*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + 2*I3*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2) + L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2)))/(I1*I2*I3 + I2*I3*L1^2*m2*sin(theta1)^2 + I2*I3*L1^2*m3*sin(theta1)^2 + I3*L1^2*L2^2*m3^2*cos(theta1)^4*sin(theta2)^2 + I3*L1^2*L2^2*m3^2*sin(theta1)^4*sin(theta2)^2 + I1*I3*L2^2*m3*cos(theta1)^2*cos(theta2)^2 + I1*I3*L2^2*m3*sin(theta1)^2*sin(theta2)^2 + I2*I3*L1^2*m2*cos(theta1)*sin(theta1) + I2*I3*L1^2*m3*cos(theta1)*sin(theta1) - I1*I3*L2^2*m3*cos(theta1)*cos(theta2)^2*sin(theta1) - I1*I3*L2^2*m3*cos(theta1)^2*cos(theta2)*sin(theta2) - I2*I3*L1*L2*m3*cos(theta1)^2*cos(theta2) + I1*I3*L2^2*m3*cos(theta1)*sin(theta1)*sin(theta2)^2 + I1*I3*L2^2*m3*cos(theta2)*sin(theta1)^2*sin(theta2) - I1*I3*L1*L2*m3*cos(theta1)^2*sin(theta2) + I2*I3*L1*L2*m3*cos(theta2)*sin(theta1)^2 - I2*I3*L1*L2*m3*cos(theta1)^2*sin(theta2) - I2*I3*L1*L2*m3*sin(theta1)^2*sin(theta2) + I3*L1^2*L2^2*m2*m3*sin(theta1)^4*sin(theta2)^2 + 2*I3*L1^2*L2^2*m3^2*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + I3*L1^2*L2^2*m2*m3*cos(theta1)*sin(theta1)^3*sin(theta2)^2 + I3*L1^2*L2^2*m2*m3*cos(theta1)^3*sin(theta1)*sin(theta2)^2 - 2*I1*I3*L2^2*m3*cos(theta1)*cos(theta2)*sin(theta1)*sin(theta2) - I1*I3*L1*L2*m3*cos(theta1)*cos(theta2)*sin(theta1) + 2*I2*I3*L1*L2*m3*cos(theta1)*sin(theta1)*sin(theta2) + I3*L1^2*L2^2*m2*m3*cos(theta1)^2*sin(theta1)^2*sin(theta2)^2 + I3*L1^2*L2^2*m2*m3*cos(theta2)*sin(theta1)^4*sin(theta2) + I3*L1^2*L2^2*m2*m3*cos(theta1)^2*cos(theta2)*sin(theta1)^2*sin(theta2) - I3*L1^2*L2^2*m2*m3*cos(theta1)*cos(theta2)*sin(theta1)^3*sin(theta2) - I3*L1^2*L2^2*m2*m3*cos(theta1)^3*cos(theta2)*sin(theta1)*sin(theta2))
 
end