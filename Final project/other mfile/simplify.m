function [qdd]=simplify(theta1,theta2,theta3,theta1dot,theta2dot,theta3dot,tau1,tau2,tau3,f1,f2,f3)
% syms theta1 theta2 theta3 theta1dot theta2dot theta3dot L1 L2 L3 m1 m2 m3 init_theta1 init_theta2 init_theta3 I1 I2 I3 tau1 tau2 tau3 g f1 f2 f3 real;

c1=cos(theta1);
c2=cos(theta2);
% c3=cos(theta3);
s1=sin(theta1);
s2=sin(theta2);
% s3=sin(theta3);
c12=cos(theta1+theta2);
s12=sin(theta1+theta2);
tic
qdd =[...
                                                                                                                                                                                                                                                                                                                                            ((((c12*(120*c1 + 90*c12))/2 - (4*s1 + 3*s12)*(40*c1 + 30*c12) - 240*c1*s1 - (s12*(120*s1 + 90*s12))/2)*theta1dot^2 + (c12*(120*c1 + 90*c12) - c12*(240*s1 + 180*s12) - 90*s12^2)*theta1dot*theta2dot + ((c12*(120*c1 + 90*c12))/2 + s12*(120*c1 + 90*c12) - (s12*(120*s1 + 90*s12))/2)*theta2dot^2 + 981*c1 + (2943*c12)/10 - f1 + tau1)*(90*c1^2*c2^2 - 90*c1^2*c2*s2 - 120*c1^2*s2 - 90*c1*c2^2*s1 - 180*c1*c2*s1*s2 - 120*c1*c2*s1 + 90*c1*s1*s2^2 + 90*c2*s1^2*s2 + 90*s1^2*s2^2 + 1/5))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) - (((90*c12^2 - s12*(120*c1 + 90*c12) - (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta1dot^2 + (90*c12^2 - s12*(120*c1 + 90*c12) - c12*(120*s1 + 90*s12) - 90*s12^2)*theta1dot*theta2dot + (90*c12*s12 + (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta2dot^2 + (2943*c12)/10 - f2 + tau2)*(90*c1^2*c2^2 - 90*c1^2*c2*s2 + 120*c1^2*c2 - 120*c1^2*s2 - 90*c1*c2^2*s1 - 180*c1*c2*s1*s2 - 240*c1*c2*s1 + 90*c1*s1*s2^2 - 120*c1*s1*s2 - 400*c1*s1 + 90*c2*s1^2*s2 + 90*s1^2*s2^2 + 120*s1^2*s2 + 1/5))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) + ((f3 - tau3)*(400*c1*s1 - 120*c1^2*c2 - 120*s1^2*s2 + 120*c1*c2*s1 + 120*c1*s1*s2))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10);...
                                                                                                                                                                                                                                                                                                                                                     ((f3 - tau3)*(120*c2*s1^2 - 120*c1^2*s2 + 400*s1^2 - 120*c1*c2*s1 + 120*c1*s1*s2 + 1/2))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) - ((((c12*(120*c1 + 90*c12))/2 - (4*s1 + 3*s12)*(40*c1 + 30*c12) - 240*c1*s1 - (s12*(120*s1 + 90*s12))/2)*theta1dot^2 + (c12*(120*c1 + 90*c12) - c12*(240*s1 + 180*s12) - 90*s12^2)*theta1dot*theta2dot + ((c12*(120*c1 + 90*c12))/2 + s12*(120*c1 + 90*c12) - (s12*(120*s1 + 90*s12))/2)*theta2dot^2 + 981*c1 + (2943*c12)/10 - f1 + tau1)*(90*c1^2*s2^2 - 90*c1^2*c2*s2 - 90*c1*c2^2*s1 + 180*c1*c2*s1*s2 + 90*c1*s1*s2^2 + 120*c1*s1*s2 + 90*c2^2*s1^2 + 90*c2*s1^2*s2 + 120*c2*s1^2 + 1/5))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) + (((90*c12^2 - s12*(120*c1 + 90*c12) - (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta1dot^2 + (90*c12^2 - s12*(120*c1 + 90*c12) - c12*(120*s1 + 90*s12) - 90*s12^2)*theta1dot*theta2dot + (90*c12*s12 + (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta2dot^2 + (2943*c12)/10 - f2 + tau2)*(90*c1^2*s2^2 - 90*c1^2*c2*s2 - 120*c1^2*s2 - 90*c1*c2^2*s1 + 180*c1*c2*s1*s2 - 120*c1*c2*s1 + 90*c1*s1*s2^2 + 240*c1*s1*s2 + 90*c2^2*s1^2 + 90*c2*s1^2*s2 + 240*c2*s1^2 + 400*s1^2 + 7/10))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10);...
 ((((c12*(120*c1 + 90*c12))/2 - (4*s1 + 3*s12)*(40*c1 + 30*c12) - 240*c1*s1 - (s12*(120*s1 + 90*s12))/2)*theta1dot^2 + (c12*(120*c1 + 90*c12) - c12*(240*s1 + 180*s12) - 90*s12^2)*theta1dot*theta2dot + ((c12*(120*c1 + 90*c12))/2 + s12*(120*c1 + 90*c12) - (s12*(120*s1 + 90*s12))/2)*theta2dot^2 + 981*c1 + (2943*c12)/10 - f1 + tau1)*(90*c1^2*s2^2 - 90*c1^2*c2^2 + 120*c1^2*s2 + 360*c1*c2*s1*s2 + 120*c1*c2*s1 + 120*c1*s1*s2 + 90*c2^2*s1^2 + 120*c2*s1^2 - 90*s1^2*s2^2))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) - (((90*c12^2 - s12*(120*c1 + 90*c12) - (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta1dot^2 + (90*c12^2 - s12*(120*c1 + 90*c12) - c12*(120*s1 + 90*s12) - 90*s12^2)*theta1dot*theta2dot + (90*c12*s12 + (c12*(120*c1 + 90*c12))/2 - 45*s12^2)*theta2dot^2 + (2943*c12)/10 - f2 + tau2)*(90*c1^2*s2^2 - 120*c1^2*c2 - 90*c1^2*c2^2 + 360*c1*c2*s1*s2 + 120*c1*c2*s1 + 360*c1*s1*s2 + 400*c1*s1 + 90*c2^2*s1^2 + 240*c2*s1^2 - 90*s1^2*s2^2 - 120*s1^2*s2 + 400*s1^2 + 1/2))/(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 24*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 84*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 48*c1*s1*s2 + 80*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 24*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 24*s1^2*s2 + 80*s1^2 + 1/10) - ((f3 - tau3)*(14400*c1^4*s2^2 - 21600*c1^3*c2*s1*s2 + 21600*c1^3*s1*s2^2 + 45*c1^2*c2^2 + 21600*c1^2*c2*s1^2*s2 - 45*c1^2*c2*s2 - 36*c1^2*c2 + 50400*c1^2*s1^2*s2^2 - 96*c1^2*s2 - 45*c1*c2^2*s1 - 21600*c1*c2*s1^3*s2 - 90*c1*c2*s1*s2 - 60*c1*c2*s1 + 21600*c1*s1^3*s2^2 + 45*c1*s1*s2^2 + 72*c1*s1*s2 + 120*c1*s1 + 21600*c2*s1^4*s2 + 45*c2*s1^2*s2 + 36*c2*s1^2 + 36000*s1^4*s2^2 + 45*s1^2*s2^2 - 36*s1^2*s2 + 120*s1^2 + 3/20))/(1440*c1^4*s2^2 - 2160*c1^3*c2*s1*s2 + 2160*c1^3*s1*s2^2 + (9*c1^2*c2^2)/2 + 2160*c1^2*c2*s1^2*s2 - (9*c1^2*c2*s2)/2 - (12*c1^2*c2)/5 + 5040*c1^2*s1^2*s2^2 - (42*c1^2*s2)/5 - (9*c1*c2^2*s1)/2 - 2160*c1*c2*s1^3*s2 - 9*c1*c2*s1*s2 - 6*c1*c2*s1 + 2160*c1*s1^3*s2^2 + (9*c1*s1*s2^2)/2 + (24*c1*s1*s2)/5 + 8*c1*s1 + 2160*c2*s1^4*s2 + (9*c2*s1^2*s2)/2 + (12*c2*s1^2)/5 + 3600*s1^4*s2^2 + (9*s1^2*s2^2)/2 - (12*s1^2*s2)/5 + 8*s1^2 + 1/100)];
 

toc
end